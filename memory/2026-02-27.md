# 2026-02-27 — Notas do Dia

## Sessão de Setup Completo (noite de 26/fev → madrugada 27/fev)

### O que foi feito
- Primeira sessão completa de setup do ambiente Archie em nova infraestrutura
- Reestabelecida identidade e dinâmica com Lincoln

### Configurações realizadas
- **Memory search:** OpenAI embeddings (text-embedding-3-small), hybrid BM25+vector, MMR (λ=0.7), temporal decay (halfLife=30d), cache 50k entradas
- **gog:** Gmail, Calendar, Drive autenticados (lincolnqjunior@gmail.com), GOG_KEYRING_PASSWORD e GOG_ACCOUNT injetados no systemd
- **sag:** ElevenLabs TTS v0.2.2, voz Brian escolhida pelo Lincoln (nPczCjzI2devNBz1zQrb), LD_LIBRARY_PATH e ELEVENLABS_VOICE_ID no systemd
- **Whisper:** OpenAI API (whisper-1), script transcribe.sh — testado com áudio do Telegram ✓
- **ffmpeg:** 8.0.1 via brew
- **Tavily:** API key configurada, venv ~/.tavily-env, tavily-python 0.7.22
- **mcporter:** 0.7.3 instalado globalmente

### Skills instaladas no workspace
ai-humanizer, clawdbot-documentation-expert, ontology, decide, escalate, learning, memory, self-improving, tavily

### Arquivos criados/atualizados
- TOOLS.md — reescrito com configurações reais
- SKILLS.md — novo, guia completo de uso das skills
- MEMORY.md — localização do Lincoln adicionada
- self-improving/memory.md — inicializado com perfil e preferências
- self-improving/corrections.md — 4 lições registradas

### Ontologia
- Lincoln (pers_fe7bca69) e Casa Petrópolis (loca_aa6021b3) criados e relacionados

### Gmail
- 50 emails categorizados com labels: Security, Dev/GitHub, Dev/Newsletter, Social/LinkedIn, Finance, Promotion
- Logins suspeitos (ElevenLabs + GitHub) confirmados pelo Lincoln como acessos legítimos do desktop dele

### Preferências confirmadas
- **Se Lincoln mandar áudio → responder em áudio** (sempre)
- Weather: usar Open-Meteo (wttr.in dá timeout nesse servidor)
- Restart gateway: usar exec simples, confirmar com status subsequente

### Lições aprendidas (self-improving)
- Nunca aceitar credenciais inline sem sugerir alternativa segura primeiro
- Python nesse ambiente: usar uv, não pip/pip3
- wttr.in não funciona — Open-Meteo é o fallback definitivo
- Gateway restart: não depender do retorno do exec

---

## Segunda rodada (00:29 GMT+1)

### agent-council instalada
- Instalação manual do GitHub (não estava no clawhub)
- Scripts: create-agent.sh, setup_channel.py, rename_channel.py
- Lição: scripts no GitHub podem usar underscore (setup_channel.py) — verificar listagem da API antes de baixar por nome

### TOOLS.md e SKILLS.md reorganizados
- Separação clara: TOOLS.md = infraestrutura/credenciais; SKILLS.md = quando/como usar
- agent-council documentada em SKILLS.md com fluxo completo de criação de agentes e coordenação multi-agente

### Estado final do workspace
- 11 skills no workspace
- 52 skills nativas no sistema
- Git: commit ead19f8 — sincronizado com GitHub
- Self-improving: 11 correções, 46 linhas de memória HOT

---

## Terceira rodada (01:00–15:30 GMT+1)

### mcporter — MCPs configurados
- `time`: funcionando (Python ~/.mcp-env, America/Sao_Paulo) ✅
- `notebooklm`: pendente — ver TODO-notebooklm.md ❌
- `context7`: on-demand via npx ⏳
- Lição: notebooklm-mcp precisa de state.json via setup_auth com DISPLAY=:99
- Google Chrome instalado via apt (necessário para notebooklm-mcp)
- Xvfb + x11vnc configurados, script start-display.sh criado

### Chrome Extension (Browser Relay)
- Extensão instalada e funcionando com TigerVNC via túnel SSH
- Porta 18792 relay ativa no gateway
- Acesso ao Chrome do Lincoln via `browser` tool com profile="chrome"

### Todoist
- Skill instalada via clawhub
- todoist-ts-cli instalado globalmente
- Token salvo em ~/.todoist-token (chmod 600) + injetado no systemd
- Lista de compras criada: 10 itens com label @mercado e due=tomorrow

### WhatsApp grupos
- Problema: groupAllowFrom tinha JID do grupo em vez do número do remetente
- Fix: groupAllowFrom=["+5521964833107"], groups=["120363406935049097@g.us"]
- Número pessoal do Lincoln: +5521964833107
- Número do bot: +5524981000288

### Dados importantes salvos
- Número pessoal Lincoln: +5521964833107 → salvo em MEMORY.md
- Número bot WhatsApp: +5524981000288 → salvo em MEMORY.md

### Estado final
- 12 skills no workspace (+ todoist)
- MEMORY.md consolidado com infraestrutura completa
- TOOLS.md atualizado com MCPs
- SKILLS.md atualizado com notebooklm
- Git sincronizado

## Sessão tarde de 27/fev — Multi-agente e comunicação inter-agente

### Problema investigado
- `sessions_send` falhava com `"Either sessionKey or label is required"` quando passado `agentId` direto
- `sessions_spawn` rejeitava `agentId` com `"agentId is not allowed for sessions_spawn (allowed: none)"`

### Solução encontrada (via docs locais)
Dois campos obrigatórios no openclaw.json:
1. `tools.sessions.visibility: "all"` — permite ver sessões cross-agent
2. `tools.agentToAgent: { enabled: true, allow: ["main", "postmaster", "oraculo"] }` — habilita canal

sessionKey correta para agentes: `agent:<agentId>:main` (ex: `agent:oraculo:main`)

### Teste confirmado
- `sessions_send(sessionKey="agent:oraculo:main", ...)` → status: "ok" ✅
- Oráculo respondeu e anunciou no Telegram via inter-session message
- Esquadrão completo e conectado nos dois sentidos

### Commits
- main: `6baec09` — agent-to-agent habilitado, MEMORY.md atualizado

---

## Noite de 27/fev — tldv API + extração de transcrições

### Objetivo
Baixar transcrições das reuniões do tldv.io sem precisar de browser/Playwright.

### Token tldv
- `~/.tldv-token` — JWT `_cap_jwt` do Chrome localStorage (tldv.io)
- Validade: 2026-03-12
- Auth: `Authorization: Bearer <token>` (cookie `tldvtoken=` retorna 403)

### Script criado
- `/home/lincoln/.openclaw/workspace/scripts/tldv-extract.py`
- API: `GET https://api.tldv.io/meetings/{id}` (metadata) + `GET /meetings/{id}/transcript` (transcrição)
- Formato da resposta: `{ "data": [ [word_obj, ...], ... ] }` — lista de segmentos, cada segmento é lista de palavras com `{word, speaker, startTime, endTime}`
- Saída: Markdown por speaker, salvo em `tldv-transcripts/{YYYY-MM}/`
- Filename: `{date}-{safe-title}-{id[:8]}.md`
- Reuniões arquivadas (plano free, >2 dias) retornam 403 — script sai com code 2 (não erro fatal)

### Bug corrigido
- Primeira versão tentava parsear repr Python (`ast.literal_eval`) — resposta era JSON válido
- `segments_to_text()` precisava de `transcript_response.get("data", [])` para acessar os segmentos

### Teste bem-sucedido
- Reunião `69a1873210f959001321ad04` — "Daily Operações/Infra/Suporte B3" (27/02, 24min)
- Output: 24.308 chars, texto legível por speaker ✓

### Oráculo — pesquisa Playwright VPS
- Oráculo documentou alternativas ao `@playwright/mcp` oficial (consome >10k tokens por página)
- `playwright-cli` via clawhub (não confirmada existência real — clawhub não retornou esse slug)
- Opção B: wrapper Node.js com `launchPersistentContext` — só relevante para retomar notebooklm-mcp
- Chrome relay continua sendo a solução para sites com Google OAuth
- Arquivo: `~/.openclaw/workspaces/oraculo/memory/research/2026-02-27-playwright-vps.md`

### Oráculo — plano de estruturação
- Plano de ação documentado em `memory/plans/2026-02-27-plano-de-acao-estrutura.md`
- Items 1, 3, 4 delegados para execução autônoma (diretórios, template de reporte, validação memory_search)
- Item 5 (notificação): apenas para Arquiteto via sessions_send

### Commits
- main: `c7150e1` — script tldv-extract.py, playwright-tldv-state.json, duas transcrições de teste
